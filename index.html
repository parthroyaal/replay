<!DOCTYPE html>
<html>
<head>
    <title>CSV Direct Loader</title>
</head>
<body>
    <!-- Multiple ways to load file -->
    <input type="file" id="csvfile" accept=".csv" onChange="loadCSV(this)">
    <br><br>
    <div id="output"></div>

    <script>
        function loadCSV(input) {
            var file = input.files[0];
            
            // Method 1: Using createObjectURL
            try {
                var objectUrl = window.URL.createObjectURL(file);
                var xhr = new XMLHttpRequest();
                xhr.open('GET', objectUrl);
                xhr.onload = function() {
                    displayData(xhr.responseText);
                    window.URL.revokeObjectURL(objectUrl);
                };
                xhr.send();
                return;
            } catch(e) {
                console.log('Method 1 failed, trying method 2');
            }

            // Method 2: Direct XHR
            try {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', file);
                xhr.onload = function() {
                    displayData(xhr.responseText);
                };
                xhr.send();
                return;
            } catch(e) {
                console.log('Method 2 failed, trying method 3');
            }

            // Method 3: Basic FileReader
            try {
                var reader = new FileReader();
                reader.onload = function(e) {
                    displayData(e.target.result);
                };
                reader.readAsText(file);
                return;
            } catch(e) {
                console.log('Method 3 failed, trying method 4');
            }

            // Method 4: Old-style FileReader
            try {
                var reader = new FileReader();
                reader.onloadend = function(e) {
                    displayData(this.result);
                };
                reader.readAsText(file);
            } catch(e) {
                console.log('All methods failed');
                document.getElementById('output').innerHTML = 'Unable to load file directly. Browser may not support file loading.';
            }
        }

        function displayData(csv) {
            try {
                var rows = csv.split('\n');
                var html = '<table border="1">';
                
                for(var i = 0; i < rows.length; i++) {
                    if(rows[i].trim()) {
                        html += '<tr>';
                        var cells = rows[i].split(',');
                        for(var j = 0; j < cells.length; j++) {
                            html += '<td>' + cells[j].trim() + '</td>';
                        }
                        html += '</tr>';
                    }
                }
                html += '</table>';
                
                document.getElementById('output').innerHTML = html;
            } catch(e) {
                document.getElementById('output').innerHTML = 'Error displaying data: ' + e.message;
            }
        }
    </script>
</body>
</html>
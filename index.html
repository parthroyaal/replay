<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CSV Data Table (Limited Rows)</title>
</head>
<body>

  <h1>CSV Data Table</h1>

  <div id="fetchSupportMessage"></div>
  <div id="fileLoadError" style="color: red;"></div> 
  <input type="file" id="csvFile" accept=".csv"> 

  <div id="tableContainer"></div>

  <script>
    const csvFile = document.getElementById('csvFile');
    const tableContainer = document.getElementById('tableContainer');
    const fetchSupportMessage = document.getElementById('fetchSupportMessage');
    const fileLoadError = document.getElementById('fileLoadError'); 
    const maxRowsToDisplay = 10;

    // Check if fetch is supported
    if (window.fetch) {
      fetchSupportMessage.textContent = "Fetch API is supported! ðŸŽ‰";
    } else {
      fetchSupportMessage.textContent = "Fetch API is not supported. ðŸ˜¥";
      csvFile.disabled = true; 
    }

    csvFile.addEventListener('change', (event) => {
      const file = event.target.files[0];
      fileLoadError.textContent = '';

      // Read the file as text using the fetch API
      const fileReader = new FileReader();
      fileReader.onload = (e) => {
        fetch(e.target.result)
          .then(response => response.text())
          .then(csvData => {
            const rows = csvData.split('\n');
            const headers = rows[0].split(',');

            const table = document.createElement('table');
            const headerRow = document.createElement('tr');

            headers.forEach(header => {
              const th = document.createElement('th');
              th.textContent = header;
              headerRow.appendChild(th);
            });
            table.appendChild(headerRow);

            for (let i = 1; i <= maxRowsToDisplay && i < rows.length; i++) {
              const row = rows[i].split(',');
              const tableRow = document.createElement('tr');

              row.forEach(cell => {
                const td = document.createElement('td');
                td.textContent = cell;
                tableRow.appendChild(td);
              });
              table.appendChild(tableRow);
            }

            tableContainer.innerHTML = '';
            tableContainer.appendChild(table);
          })
          .catch(error => {
            console.error('Error reading CSV file:', error);
            fileLoadError.textContent = `Error loading CSV data: ${error.message}`; 
          });
      };
      fileReader.readAsDataURL(file); 

      // Explicitly trigger a click on the file input (for browsers that might need it)
      csvFile.click();
    });
  </script>
</body>
</html>